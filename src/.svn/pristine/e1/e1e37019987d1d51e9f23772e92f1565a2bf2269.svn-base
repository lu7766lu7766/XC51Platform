/**
 * 我的彩票
 */
class MyLotteryWnd extends egret.DisplayObjectContainer{
    private static _mInstance: MyLotteryWnd;
	public static get getInstance(): MyLotteryWnd {
		if (MyLotteryWnd._mInstance == undefined)
			MyLotteryWnd._mInstance = new MyLotteryWnd();
		return MyLotteryWnd._mInstance;
	}

    private _topUI:TopUI;
    private _return:egret.Shape;
	/**当前选中 */
	private _mXZLink:egret.Shape;

    private _topContain:egret.DisplayObjectContainer;
	private _srcItem = ["全部","待出票","待开奖","已开奖","已中奖"];
    private _index = 0;

    constructor(){
        super();
        this.y = 40;
        this._topUI = new TopUI("",-this.y);
		this._topUI.changeTitle("我的彩票");
        this.addChild(this._topUI);
        this._return = this._topUI.getReturn();
        this._return.addEventListener(egret.TouchEvent.TOUCH_TAP,()=>{
            this.hide();
        },this);

        this._topContain = new egret.DisplayObjectContainer();
        this.addTop();
		this.init();
		this.setDB()

		this.touchEnabled = true;
    }

	private init():void {
		let link = new egret.Shape();
        this.addChild(link);
        link.graphics.beginFill(0xdedede);
        link.graphics.drawRect(0,136 + this.y,750,1.5);

		this._mXZLink = new egret.Shape();
        this.addChild(this._mXZLink);
        this._mXZLink.graphics.beginFill(0xF72D52);
        this._mXZLink.graphics.drawRect(52,212 - this.y,48,4);

		for(let i=0;i<this._srcItem.length;i++){
            let text:egret.TextField = ToolMrg.getText(i*150,136 - this.y,26,0x292929,150);
			text.height = 80;
            text.textAlign = egret.HorizontalAlign.CENTER;
			text.verticalAlign = egret.VerticalAlign.MIDDLE;
            text.text = this._srcItem[i];
			this.addChild(text);
			text.touchEnabled = true;
			text.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchDown,this);
        }
	}

	private _mShareC: egret.Shape;
	/**适配处理 */
	private setDB(): void {
		this._mShareC = new egret.Shape();
		this._mShareC.graphics.beginFill(0xffffff, 1);
		this._mShareC.graphics.drawRect(0, 0, GameMain.getInstance.StageWidth,GameMain.getInstance.StageHeight);
		this.addChildAt(this._mShareC, 0);
    }

    private addTop():void{
        this.addChild(this._topContain);
        this._topContain.y = 16;
    }

	/**切换按钮 */
	public changeWnd(index:number):void {
		// this._mXZLink.x = index * 150
		egret.Tween.removeTweens(this._mXZLink)
		egret.Tween.get(this._mXZLink).to({x:index * 150},100);
	}

    private touchDown(e:egret.TouchEvent):void{
		if(e.target instanceof egret.TextField) {
			let touch:egret.TextField = e.target;
			if(touch.text == this._srcItem[0]) {//全部
				this.changeWnd(0);
			} else if(touch.text == this._srcItem[1]) {//待出票
				this.changeWnd(1);
			} else if(touch.text == this._srcItem[2]) {//待开奖
				this.changeWnd(2);
			} else if(touch.text == this._srcItem[3]) {//已开奖
				this.changeWnd(3);
			} else if(touch.text == this._srcItem[4]) {//已中奖
				this.changeWnd(4);
			}
		}
    }


    public show(index?:number):void{
        GUIManager.getInstance.tipLay.addChild(this);
		if(index != undefined) {
			this.changeWnd(index);
		} else {
			this.changeWnd(0);
		}
    }

    public hide():void{
        if(this.parent!=undefined){
            this.parent.removeChild(this);
            G1Wnd.getInstance.hide();
            G2Wnd.getInstance.hide();
        }
    }
}