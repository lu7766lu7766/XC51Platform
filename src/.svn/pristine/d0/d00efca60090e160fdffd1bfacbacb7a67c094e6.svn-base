/**
 * 篮球:
http://192.168.20.23/ticket/test/bk_List.php
{
    "res": 0,
    "map": [
        {
            "time": "2019-06-11 周二",   //时间
            "list": [
                {
                    "0": "",  //不让分主胜
                    "1": "",  //不让分客胜
                    "3": "1.7",  //让分主胜
                    "4": "1.7",  //让分客胜
                    "id": "354638",  //赛事id
                    "day": "周二",  //周几
                    "league_name": "NBA",  //联赛
                    "lot_lose": "-1.50",    //让分
                    "no_lose": "0",         //不让分
                    "team_a_name": "猛龙",   //主队昵称
                    "team_b_name": "勇士",   //客队昵称
                    "stop": "08:50"     //停止销售时间
                }
            ]
        }
    ]
}
 */
class BK_List implements IProHandle {
	private static _mInstance: BK_List;
	public static get getInstance(): BK_List {
		if (BK_List._mInstance == undefined)
			BK_List._mInstance = new BK_List();
		return BK_List._mInstance;
	}
	/**对象key */
	private data: HttpData;
	private constructor() {
		this.data = new HttpData();
		this.data.mKey = "BK_List";
	}

	/**
	 * 注数列表
	 */
	public sendHttp(): void {
		let url: string = HTTPRequest.getInstance.httpHeadUrl + "/bk_List.php";
		let content = ``;
		HTTPRequest.getInstance.proSend(url, content, this.data);
	}

	public backHTTP(res: boolean, httpObj: egret.HttpRequest, data: HttpData): void {
        if (res == true && httpObj.response != "") {//请求成功
            let text: Object;
            try {
				text = JSON.parse(httpObj.response);
			} catch (error) {
				return;
			}
            if(text["res"]!="0"){
                Alertpaner.getInstance.show(text["res"]+":"+text["msg"]);
            } else {
				let map:Array<any> = text["map"];
				let lq:GHashMap<BasketballData>;
				let dd:BasketballData;
				for(let k=0;k<map.length;k++) {
					let time:string = map[k]["time"];
					let arr:Array<any> = map[k]["list"];
					lq = new GHashMap<BasketballData>();
					for(let i=0;i<arr.length;i++) {
						dd = new BasketballData();
						dd.code = i;
						dd.id = arr[i]["id"];
						dd.time = time;
						for(let j=0;j<4;j++) {
							dd.listSX[j] = arr[i][j];
						}
						dd.day = arr[i]["day"];
						dd.league_name = arr[i]["league_name"];
						dd.lot_lose = arr[i]["lot_lose"];
						dd.no_lose = arr[i]["no_lose"];
						dd.team_a_name = arr[i]["team_a_name"];
						dd.team_b_name = arr[i]["team_b_name"];
						dd.stop = arr[i]["stop"];
						lq.Gput(dd.id, dd);
					}
					BasketballDataMrg.getInstance.addData(time, lq);
				}
				
			}
        }
    }
}