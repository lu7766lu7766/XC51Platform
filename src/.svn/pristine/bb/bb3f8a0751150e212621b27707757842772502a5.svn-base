/**足球即时数据显示*/
class football1 extends egret.DisplayObjectContainer {
	private static _mInstance: football1;
	public static get getInstance(): football1 {
		if (football1._mInstance == undefined)
			football1._mInstance = new football1();
		return football1._mInstance;
	}
	public constructor() {
		super();
		this._mListObj = new GHashMap<footballitem1>();
		this._mContainQB = new egret.DisplayObjectContainer();
		this._scroViewQB = new egret.ScrollView();
		this.addChild(this._scroViewQB)
		this.addScoll(this._mContainQB, this._scroViewQB);

		let link = new egret.Shape();
		this.addChild(link);
		link.graphics.beginFill(0xF5F5F7);
		link.graphics.drawRect(0, 0, GameMain.getInstance.StageWidth, 10);
		link.graphics.endFill();
	}

	/**全部信息 滚动 */
	private _mContainQB: egret.DisplayObjectContainer;
	private _scroViewQB: egret.ScrollView;
	private _mListObj: GHashMap<footballitem1>;//数据列表

	private addScoll(contain: egret.DisplayObjectContainer, scroView: egret.ScrollView): void {
		scroView.x = 0;
		scroView.y = 10;
		scroView.scrollSpeed = 0.4;
		//设置滚动内容
		scroView.setContent(contain);
		scroView.bounces = false;
		scroView.verticalScrollPolicy = 'on';
		scroView.horizontalScrollPolicy = 'off';
		//设置滚动区域宽高
		scroView.width = GameMain.getInstance.StageWidth;
		scroView.height = GameMain.getInstance.StageHeight - 320;
		scroView.bounces = true;
	}

	public show() {
		let connet: egret.DisplayObjectContainer = FallViewMrg.getInstance.getconnet();
		if (this.parent == undefined) {
			connet.addChild(this);
		}
		this.initallInfo();
	}

	public hide(): void {
		if (this == undefined) return;
		if (this.parent != undefined) {
			this.parent.removeChild(this);
		}
	}

	/**初始化所有数据*/
	public initallInfo(): void {
		let len: number = 0;
		len = FootballConfinData.getInstance.getlist().size;
		let dataObj: footballitem1;
		for (let i = 1; i <= len; i++) {
			dataObj = this._mListObj.Gget(i);
			if (dataObj == undefined) {
				dataObj = new footballitem1();
				this._mListObj.Gput(i, dataObj);
			}
			dataObj.setID(i);
			let data: footballCofObj = FootballConfinData.getInstance.getInfo(i);
			if (data != undefined) {
				dataObj.setInfo1(data.name, data.timer, data.leftname, data.bfText, data.bcBF, data.rightname);
				dataObj.setIcon(data.leftIcon);
				dataObj.setIconright(data.rightIcon);
				dataObj.setLeft(data.leftyellownum, data.leftrednum);
				dataObj.setright(data.rightyellownum, data.rightrednum);
				dataObj.setxingxing(data.ifgz);
				let status: number = data.status;
				if (status == 1 || status == 2 || status == 3 || status == 4 || status == 5) {
					dataObj.resultTextset(1, data.touding);
				} else {
					if (status == 0) {
						dataObj.resultTextset(3, data.getstatus());
					} else {
						dataObj.resultTextset(1, data.getstatus());
					}
				}
				dataObj.setmothday(data.rqday);

			}
			dataObj.setPoint(0, 10 + (i - 1) * 125);
			if (dataObj.parent == undefined) {
				this._mContainQB.addChild(dataObj);
			}
		}
		this._scroViewQB.setScrollTop(20);
	}

	//清除对象数组
	public hideData(): void {
		for (let key of this._mListObj.keys) {
			let data: footballitem1 = this._mListObj.Gget(key);
			if (data != undefined) {
				if (data.parent != undefined) {
					data.parent.removeChild(data);
				}
			}
		}
	}
}

class footballitem1 extends egret.DisplayObjectContainer {
	public constructor() {
		super();

		if (this._mBg == undefined) {
			this._mBg = new egret.Shape();
			this.addChild(this._mBg);
			this._mBg.graphics.beginFill(0xffffff);
			this._mBg.graphics.drawRect(0, 0, GameMain.getInstance.StageWidth, 122);
			this._mBg.graphics.endFill()

			let link = new egret.Shape();
			this.addChild(link);
			link.graphics.beginFill(0xF5F5F7);
			link.graphics.drawRect(0, 122, GameMain.getInstance.StageWidth, 3);
			link.graphics.endFill();
		}

		this.name1 = ToolMrg.getText(28, 16, 20, 0xFF7000, 150);
		this.name1.text = "欧洲冠杯";
		this.name1.fontFamily = "微软雅黑";
		this.addChild(this.name1);

		this.timer = ToolMrg.getText(28, 50, 20, 0x999999, 150);
		this.timer.text = "19 : 20";
		this.timer.fontFamily = "微软雅黑";
		this.addChild(this.timer);

		this.countryleftIcon = new egret.Bitmap();
		this.countryleftIcon.x = 120;
		this.countryleftIcon.y = 42;
		this.countryleftIcon.width = 40;
		this.countryleftIcon.height = 40;
		this.addChild(this.countryleftIcon);
		RES.getResByUrl("resource/assets/images/ui/wt_expert@2x.png", this.bgBack1, this, RES.ResourceItem.TYPE_IMAGE);

		this.countryleftName = ToolMrg.getText(170, 46, 24, 0x333333, 165);
		this.countryleftName.text = "王家马德里";
		this.countryleftName.fontFamily = "微软雅黑";
		this.addChild(this.countryleftName);

		this.biNumText = ToolMrg.getText(0, 0, 28, 0x333333, 750);
		this.biNumText.text = "5 : 8";
		this.biNumText.height = 121;
		this.biNumText.textAlign = egret.HorizontalAlign.CENTER;
		this.biNumText.verticalAlign = egret.VerticalAlign.MIDDLE;
		this.biNumText.fontFamily = "微软雅黑";
		this.addChild(this.biNumText);


		this.baNumText = ToolMrg.getText(0, 80, 18, 0x999999, 750);
		this.baNumText.text = "半场 1:0";
		this.baNumText.textAlign = egret.HorizontalAlign.CENTER;
		this.baNumText.fontFamily = "微软雅黑";
		this.addChild(this.baNumText);

		this.redleftbg = new egret.Shape();
		this.addChild(this.redleftbg);
		this.redleftbg.graphics.beginFill(0xE72E52);
		this.redleftbg.graphics.drawRoundRect(246, 84, 18, 18, 2);
		this.redleftbg.graphics.endFill()

		this.yellowleftbg = new egret.Shape();
		this.addChild(this.yellowleftbg);
		this.yellowleftbg.graphics.beginFill(0xFCB21A);
		this.yellowleftbg.graphics.drawRoundRect(270, 84, 18, 18, 2);
		this.yellowleftbg.graphics.endFill()

		this.reNum = ToolMrg.getText(246, 84, 16, 0xffffff, 18);
		this.reNum.text = "1";
		this.reNum.height = 18;
		this.reNum.textAlign = egret.HorizontalAlign.CENTER;
		this.reNum.verticalAlign = egret.VerticalAlign.MIDDLE;
		this.reNum.fontFamily = "微软雅黑";
		this.addChild(this.reNum);

		this.yellowleft = ToolMrg.getText(270, 84, 16, 0xffffff, 18);
		this.yellowleft.text = "2";
		this.yellowleft.height = 18;
		this.yellowleft.textAlign = egret.HorizontalAlign.CENTER;
		this.yellowleft.verticalAlign = egret.VerticalAlign.MIDDLE;
		this.yellowleft.fontFamily = "微软雅黑";
		this.addChild(this.yellowleft);

		this.countryrightIcon = new egret.Bitmap();
		this.countryrightIcon.x = 456;
		this.countryrightIcon.y = 42;
		this.countryrightIcon.width = 40;
		this.countryrightIcon.height = 40;
		this.addChild(this.countryrightIcon);
		RES.getResByUrl("resource/assets/images/ui/wt_expert@2x.png", this.bgBack2, this, RES.ResourceItem.TYPE_IMAGE);

		this.countryrightName = ToolMrg.getText(504, 46, 24, 0x333333, 165);
		this.countryrightName.text = "王家马德里";
		this.countryrightName.fontFamily = "微软雅黑";
		this.addChild(this.countryrightName);

		this.redrightbg = new egret.Shape();
		this.addChild(this.redrightbg);
		this.redrightbg.graphics.beginFill(0xE72E52);
		this.redrightbg.graphics.drawRoundRect(484, 84, 18, 18, 2);
		this.redrightbg.graphics.endFill()

		this.yellowrightbg = new egret.Shape();
		this.addChild(this.yellowrightbg);
		this.yellowrightbg.graphics.beginFill(0xFCB21A);
		this.yellowrightbg.graphics.drawRoundRect(460, 84, 18, 18, 2);
		this.yellowrightbg.graphics.endFill()

		this.reNumright = ToolMrg.getText(484, 84, 16, 0xffffff, 18);
		this.reNumright.text = "1";
		this.reNumright.height = 18;
		this.reNumright.textAlign = egret.HorizontalAlign.CENTER;
		this.reNumright.verticalAlign = egret.VerticalAlign.MIDDLE;
		this.reNumright.fontFamily = "微软雅黑";
		this.addChild(this.reNumright);

		this.yellowright = ToolMrg.getText(460, 84, 16, 0xffffff, 18);
		this.yellowright.text = "2";
		this.yellowright.height = 18;
		this.yellowright.textAlign = egret.HorizontalAlign.CENTER;
		this.yellowright.verticalAlign = egret.VerticalAlign.MIDDLE;
		this.yellowright.fontFamily = "微软雅黑";
		this.addChild(this.yellowright);

		this.xingOnclick = new egret.Shape();
		this.addChild(this.xingOnclick);
		this.xingOnclick.graphics.beginFill(0xffffff);
		this.xingOnclick.graphics.drawRoundRect(690, 40, 40, 40, 2);
		this.xingOnclick.graphics.endFill()
		this.xingOnclick.touchEnabled = true;

		this.xingxing = new egret.Bitmap();
		this.xingxing.x = 700;
		this.xingxing.y = 50;
		this.xingxing.width = 24;
		this.xingxing.height = 24;
		this.addChild(this.xingxing);
		RES.getResByUrl("resource/assets/images/ui/follow_nor_match@2x.png", this.bgBack3, this, RES.ResourceItem.TYPE_IMAGE);

		this.resultText = ToolMrg.getText(0, 16, 20, 0x999999, 750);
		this.resultText.text = "未开";
		this.resultText.textAlign = egret.HorizontalAlign.CENTER;
		this.resultText.fontFamily = "微软雅黑";
		this.addChild(this.resultText);

		this.nianmothTimer = ToolMrg.getText(30, 86, 20, 0x999999, 300);
		this.nianmothTimer.text = "";
		this.nianmothTimer.fontFamily = "微软雅黑";
		this.addChild(this.nianmothTimer);

		this.addevent();

	}

	private _mBg: egret.Shape;//背景
	private name1: egret.TextField;//世界杯名字
	private timer: egret.TextField;//时间
	private myid: number = 0;//自身id
	private countryleftIcon: egret.Bitmap;//国家左图标
	private countryleftName: egret.TextField;//国家左名字
	private biNumText: egret.TextField;//国家分数比
	private baNumText: egret.TextField;//半场比
	private redleftbg: egret.Shape;//红左
	private yellowleftbg: egret.Shape;//黄色左
	private reNum: egret.TextField;//红左数字
	private yellowleft: egret.TextField;//黄左
	private countryrightIcon: egret.Bitmap;//国家右图标
	private countryrightName: egret.TextField;//国家右名字
	private redrightbg: egret.Shape;//红右
	private yellowrightbg: egret.Shape;//黄色右
	private reNumright: egret.TextField;//红右数字
	private yellowright: egret.TextField;//黄右
	private xingxing: egret.Bitmap;//星星
	private xingOnclick: egret.Shape;//星星点击
	private resultText: egret.TextField;//结果比分或完场 未公开
	private nianmothTimer: egret.TextField;//年月日时间


	public setID(id: number): void {
		this.myid = id;
	}

	public setPoint(x: number, y: number): void {
		this.x = x;
		this.y = y;
	}

	private bgBack1(data: any, url: string): void {
		if (data != undefined && this.countryleftIcon != undefined) {
			this.countryleftIcon.$setBitmapData(data);
		}
	}

	private bgBack2(data: any, url: string): void {
		if (data != undefined && this.countryrightIcon != undefined) {
			this.countryrightIcon.$setBitmapData(data);
		}
	}

	private bgBack3(data: any, url: string): void {
		if (data != undefined && this.xingxing != undefined) {
			this.xingxing.$setBitmapData(data);
		}
	}

	/**设置信息*/
	public setInfo1(name1: string, timer: string, leftname: string, centerb: string, banb: string, name2: string): void {
		this.name1.text = ToolMrg.nameMode(7, name1);
		this.timer.text = timer;
		this.countryleftName.text = ToolMrg.nameMode(7, leftname);
		this.biNumText.text = centerb;
		this.baNumText.text = banb;
		this.countryrightName.text = ToolMrg.nameMode(7, name2);
	}

	/**设置黄红排左 */
	public setLeft(yellow: number, red: number): void {
		this.yellowleft.text = yellow + "";
		this.reNum.text = red + "";
		if (yellow > 0) {
			this.yellowleftbg.visible = true;
		} else {
			this.yellowleftbg.visible = false;
		}

		if (red > 0) {
			this.redleftbg.visible = true;
		} else {
			this.redleftbg.visible = false;
		}
	}

	/**设置黄红排右*/
	public setright(yellow: number, red: number): void {
		this.yellowright.text = yellow + "";
		this.reNumright.text = red + "";
		if (yellow > 0) {
			this.yellowrightbg.visible = true;
		} else {
			this.yellowrightbg.visible = false;
		}

		if (red > 0) {
			this.redrightbg.visible = true;
		} else {
			this.redrightbg.visible = false;
		}
	}

	/**设置赛果 1 有分数 2 完场 3未开  */
	public resultTextset(type: number, result: string): void {
		if (type == 1 || type == 2) {
			this.resultText.textColor = 0xF72E52;
		} else {
			this.resultText.textColor = 0x999999;
		}
		this.resultText.text = result + "";
	}


	/**设置国家头像左 */
	public setIcon(ul: string) {
		if (ul != undefined && ul != "") {
			LoadNetPic.getLoadNetPic.loadPic(ul, this.imgEvent_, this);
		}
		//this.countryleftIcon.$setBitmapData(GResCache.getRes(ul));
	}
	private imgEvent_(e: egret.Texture): void {
		if (this.countryleftIcon == undefined) return;
		this.countryleftIcon.$setTexture(e);
		this.countryleftIcon.width = 40;
		this.countryleftIcon.height = 40;
	}

	/**设置国家头像右 */
	public setIconright(ul: string) {
		if (ul != undefined && ul != "") {
			LoadNetPic.getLoadNetPic.loadPic(ul, this.imgEvent_1, this);
		}
	}
	private imgEvent_1(e: egret.Texture): void {
		try {
			if (this.countryrightIcon == undefined) return;
			this.countryrightIcon.$setTexture(e);
			this.countryrightIcon.width = 40;
			this.countryrightIcon.height = 40;
		} catch (error) {

		}
	}

	/**设置星星是否关注了(1 已关注 0未关注) */
	public setxingxing(type: number): void {
		if (type == 1) {
			RES.getResByUrl("resource/assets/images/ui/follow_match@2x.png", this.bgBack3, this, RES.ResourceItem.TYPE_IMAGE);
		} else {
			RES.getResByUrl("resource/assets/images/ui/follow_nor_match@2x.png", this.bgBack3, this, RES.ResourceItem.TYPE_IMAGE);
		}
	}

	/**设置年月日时间 */
	public setmothday(str: string): void {
		this.nianmothTimer.text = str;
	}

	private addevent(): void {
		this.xingOnclick.addEventListener(egret.TouchEvent.TOUCH_TAP, this.onTouch, this);
		CustEventMrg.getInstance.addEventListener(CustEventType.EventType_gzSuccess, this.updata, this);
		CustEventMrg.getInstance.addEventListener(CustEventType.EventType_gzdefeated, this.updata1, this);
	}

	private onTouch() {
		let type: number = BakorfallViewMrg.inIndex;
		let data: footballCofObj
		if (type == 2) {//即时列表
			data = FootballConfinData.getInstance.getInfo(this.myid);
		} else if (type == 3) {//关注列表
			data = FootballConfinData.getInstance.getInfo3(this.myid);
		}
		if (data != undefined) {
			BasketFootGZConfin.getInstance.sendHttp(data.id, 1);
		}

	}

	private updata() {
		let type: number = BakorfallViewMrg.inIndex;
		let data: footballCofObj
		if (type == 2) {//即时列表
			data = FootballConfinData.getInstance.getInfo(this.myid);
		} else if (type == 3) {//关注列表
			data = FootballConfinData.getInstance.getInfo3(this.myid);
		}
		if (data != undefined) {
			if (data.id == BasketFootGZConfin.uid) {
				this.setxingxing(1);
				data.ifgz = 1;
				if (type == 2) {
					FootballConfinData.getInstance.getlist3().Gput(this.myid, data);
				}
				console.log("关注成功uid=" + data.id + "本类id==" + this.myid);
			}
		}
	}

	private updata1() {
		let type: number = BakorfallViewMrg.inIndex;
		let data: footballCofObj
		if (type == 2) {//即时列表
			data = FootballConfinData.getInstance.getInfo(this.myid);
		} else if (type == 3) {//关注列表
			data = FootballConfinData.getInstance.getInfo3(this.myid);
			let jsdata: footballCofObj = FootballConfinData.getInstance.getInfo(this.myid);
			if (jsdata != undefined) {
				jsdata.ifgz = 0;
			}
		}
		if (data != undefined) {
			if (data.id == BasketFootGZConfin.uid) {
				this.setxingxing(0);
				data.ifgz = 0;
				FootballConfinData.getInstance.getlist3().GremoveByKey(this.myid);
				console.log("取消关注uid=" + data.id + "本类id==" + this.myid);
			}
		}
	}
}