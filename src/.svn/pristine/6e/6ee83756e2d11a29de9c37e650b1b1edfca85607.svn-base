/**我的页面 */
class MyViewWnd extends egret.DisplayObjectContainer{
    private static _mInstance: MyViewWnd;
	public static get getInstance(): MyViewWnd {
		if (MyViewWnd._mInstance == undefined)
			MyViewWnd._mInstance = new MyViewWnd();
		return MyViewWnd._mInstance;
	}
    private _mContain:egret.DisplayObjectContainer;
    private _scroView:egret.ScrollView;

    private _centerContain:egret.DisplayObjectContainer;
    private _downContain:egret.DisplayObjectContainer;
    private _downInfo:GHashMap<MyViewInfo>;
    private _downSrc = ["我的提成","会员拉新活动","资金明细","账户信息","彩店信息","51合营计划","优惠券","联系客服","清除缓存","关于我们"];
    private _downImgsrc = ["ticheng_mine@2x","laxin_mine@2x","yjmx_mine@2x","zhxx_mine@2x","dpu_mine@2x","hyjh_mine@2x","yhq_mine@2x","kefu_mine@2x","huancun_mine@2x","gywm_mine@2x"];

    private _txzz:egret.Shape;
    private _storeImg:egret.Bitmap;
    private _storeName:egret.TextField;
    private _News:egret.Bitmap;
    private _tx:egret.Bitmap;
    private _txName:egret.TextField;
    private _money:egret.TextField;

    private _recharge:egret.Bitmap;
    private _rechargeText:egret.TextField;
    private _cashOut:egret.Bitmap;
    private _cashOutText:egret.TextField;

    /**中间从左到右 */
    private _t1:egret.BitmapText;
    private _t2:egret.BitmapText;
    private _t3:egret.BitmapText;
    private _srcItem = ["待出票","待开奖","已中奖"];
    private _item:GHashMap<egret.Shape>;

    constructor(){
        super();
        this.y = 40;
        this._mContain = new egret.DisplayObjectContainer();
        this._item = new GHashMap<egret.Shape>();

        let myImgTop = new egret.Bitmap();
        this._mContain.addChild(myImgTop);
        RES.getResByUrl("resource/assets/images/ui/bg_mine@2x.png",(e)=>{myImgTop.$setBitmapData(e); },this);
        
        
        this._storeImg = new egret.Bitmap();
        this._mContain.addChild(this._storeImg);
        this._storeImg.x = 40;
        this._storeImg.y = 34+this.y;
        RES.getResByUrl("resource/assets/images/ui/cd_mine@2x.png",(e)=>{
            this._storeImg.$setBitmapData(e);    
        },this);

        this._storeName = ToolMrg.getText(92,28+this.y,32,0xffffff);
        this._mContain.addChild(this._storeName);
        this._storeName.text = "51竞彩";

        this._News = new egret.Bitmap();
        this._mContain.addChild(this._News);
        this._News.x = 666;
        this._News.y = 28+this.y;
        RES.getResByUrl("resource/assets/images/ui/xiaoxi_mine@2x.png",(e)=>{
            this._News.$setBitmapData(e);  
        },this);

        this._txzz = new egret.Shape();
        this._mContain.addChild(this._txzz);
        this._txzz.graphics.beginFill(0xffffff);
        this._txzz.graphics.drawEllipse(40,106+this.y,96,96);

        this._tx = new egret.Bitmap();
        this._mContain.addChild(this._tx);
        this._tx.width = 88;
        this._tx.height = 88;
        this._tx.x = 44;
        this._tx.y = 110+this.y;
        RES.getResByUrl("resource/assets/images/ui/user_default@2x.png",(e)=>{
            this._tx.$setBitmapData(e);  
        },this);

        this._txName = ToolMrg.getText(160,106+this.y,36,0xffffff);
        this._mContain.addChild(this._txName);
        this._txName.text = "大神518";

        this._money = ToolMrg.getText(160,164+this.y,28,0xffffff);
        this._mContain.addChild(this._money);
        this._money.text = "余额：28885元";

        this._cashOut = new egret.Bitmap();
        this._mContain.addChild(this._cashOut);
        this._cashOut.x = 520;
        this._cashOut.y = 264+this.y;
        RES.getResByUrl("resource/assets/images/ui/tixian_mine@2x.png",(e)=>{
            this._cashOut.$setBitmapData(e);  
        },this);

        this._recharge = new egret.Bitmap();
        this._mContain.addChild(this._recharge);
        this._recharge.x = 142;
        this._recharge.y = 264+this.y;
        RES.getResByUrl("resource/assets/images/ui/cz_mine@2x.png",(e)=>{
            this._recharge.$setBitmapData(e);  
        },this);

        this._rechargeText = ToolMrg.getText(184,258+this.y,32,0xffffff);
        this._mContain.addChild(this._rechargeText);
        this._rechargeText.text = "充值";

        this._cashOutText = ToolMrg.getText(564,258+this.y,32,0xffffff);
        this._mContain.addChild(this._cashOutText);
        this._cashOutText.text = "提款";

        this.addCenter();
        this.addDown();
        this.addScoll();
    }

    /**票 */
    private _myTicket:egret.Shape;
    private addCenter():void{
        this._centerContain = new egret.DisplayObjectContainer();
        this._mContain.addChild(this._centerContain);
        this._centerContain.y = 360;

        let centerShape = new egret.Shape();
        this._centerContain.addChild(centerShape);
        centerShape.graphics.beginFill(0xf5f5f7);
        centerShape.graphics.drawRect(0,2,750,10);

        this._myTicket = new egret.Shape();
        this._centerContain.addChild(this._myTicket);
        this._myTicket.graphics.beginFill(0xffffff);
        this._myTicket.graphics.drawRect(0,12,750,112);
        this._myTicket.touchEnabled = true;

        let myTicket = new egret.Bitmap();
        myTicket.x = 40;
        myTicket.y = 52;
        this._centerContain.addChild(myTicket);
        RES.getResByUrl("resource/assets/images/ui/caip_mine@2x.png",(e)=>{
            myTicket.$setBitmapData(e);  
        },this);

        let ticketT = ToolMrg.getText(104,12,32,0x333333);
        this._centerContain.addChild(ticketT);
        ticketT.height = 112;
        ticketT.verticalAlign = egret.VerticalAlign.MIDDLE;
        ticketT.text = "我的彩票";

        let ticketText = ToolMrg.getText(640,12,24,0x999999);
        this._centerContain.addChild(ticketText);
        ticketText.height = 112;
        ticketText.verticalAlign = egret.VerticalAlign.MIDDLE;
        ticketText.text = "全部";

        let ticketBtn = new egret.Bitmap();
        this._centerContain.addChild(ticketBtn);
        ticketBtn.x = 694;
        RES.getResByUrl("resource/assets/images/ui/xq1_nav@2x.png",(e)=>{
            ticketBtn.$setBitmapData(e);  
            ticketBtn.y = 12+(112-ticketBtn.height)*0.5;
        },this);

        let lShape2 = new egret.Shape();
        this._centerContain.addChild(lShape2);
        lShape2.graphics.beginFill(0xdedede);
        lShape2.graphics.drawRect(0,124,750,1.5);

        for(let i=0;i<this._srcItem.length;i++){
            let shape = new egret.Shape();
            shape.graphics.beginFill(0xffffff);
            shape.graphics.drawRect(i*250,125,250,128);
            shape.touchEnabled = true;
            shape.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchDown,this);
            this._centerContain.addChild(shape);
            this._item.Gput(i,shape);

            let text = ToolMrg.getText(i*250,194,24,0x292929,250);
            text.textAlign = egret.HorizontalAlign.CENTER;
            this._centerContain.addChild(text);
            text.text = this._srcItem[i];
        }

        let lShape3 = new egret.Shape();
        this._centerContain.addChild(lShape3);
        lShape3.graphics.beginFill(0xf5f5f7);
        lShape3.graphics.drawRect(0,252,750,10);

        this._t1 = FontMgr.getText(FontMgr.FONT_1);
        this._centerContain.addChild(this._t1);
        this._t1.y = 144;
        this._t1.x = 0;
        this._t1.width = 250;
        this._t1.textAlign = egret.HorizontalAlign.CENTER;

        this._t2 = FontMgr.getText(FontMgr.FONT_1);
        this._centerContain.addChild(this._t2);
        this._t2.y = 144;
        this._t2.x = 250;
        this._t2.width = 250;
        this._t2.textAlign = egret.HorizontalAlign.CENTER;

        this._t3 = FontMgr.getText(FontMgr.FONT_1);
        this._centerContain.addChild(this._t3);
        this._t3.y = 144;
        this._t3.x = 250*2;
        this._t3.width = 250;
        this._t3.textAlign = egret.HorizontalAlign.CENTER;

        this._t1.text = "12";
        this._t2.text = "0";
        this._t3.text = "8";

        this._myTicket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchDown,this);
    }

    private touchDown(e:egret.TouchEvent):void{
        if(e.target == this._myTicket){

        }else if(e.target == this._item.Gget(0)){//待出票

        }else if(e.target == this._item.Gget(1)){//待开奖
            
        }else if(e.target == this._item.Gget(2)){//已中奖
            
        }
    }

    private addDown():void{
        this._downContain = new egret.DisplayObjectContainer();
        this._mContain.addChild(this._downContain);
        this._downContain.y = this._centerContain.y + 262;

        for(let i=0;i<this._downSrc.length;i++){
            let obj = new MyViewInfo(this._downImgsrc[i],this._downSrc[i],i);
            obj.y = i*115;
            this._downContain.addChild(obj);
        }

        let downShape = new egret.Shape();
        this._downContain.addChild(downShape);
        downShape.graphics.beginFill(0xffffff);
        downShape.graphics.drawRect(0,115*this._downSrc.length,750,148);

        let exitBtn = new egret.Bitmap();
        this._downContain.addChild(exitBtn);
        exitBtn.y = 115*this._downSrc.length+38;
        RES.getResByUrl("resource/assets/images/ui/putout_mine@2x.png",(e)=>{
            exitBtn.$setBitmapData(e);
            exitBtn.x = (750 - exitBtn.width)*0.5;
        },this);
    }

    public hide():void{
        if(this.parent!=undefined){
            this.parent.removeChild(this);
        }
    }

    public show():void{
        GUIManager.getInstance.bgLay.addChild(this);
    }

    private addScoll(): void {
		this._scroView = new egret.ScrollView();
		this._scroView.x = 0;
		this._scroView.y = -this.y;
		this._scroView.scrollSpeed = 0.4;
		//设置滚动内容
		this._scroView.setContent(this._mContain);
		this._scroView.bounces = false;
		this._scroView.verticalScrollPolicy = 'on';
		this._scroView.horizontalScrollPolicy = 'off';
		//设置滚动区域宽高
		this._scroView.width = GameMain.getInstance.StageWidth;
		this._scroView.height = GameMain.getInstance.StageHeight - this.y - 100 - this._scroView.y;
		this.addChild(this._scroView);
	}
}

class MyViewInfo extends egret.DisplayObjectContainer{
    private _id;
    private _img:egret.Bitmap;
    private _text:egret.TextField;

    constructor(imgSrc,text,id){
        super();
        this._id = id;

        this._img = new egret.Bitmap();
        this.addChild(this._img);
        this._img.x = 40;
        RES.getResByUrl(`resource/assets/images/ui/${imgSrc}.png`,(e)=>{
            this._img.$setBitmapData(e);
        this._img.y = (115-this._img.height)*0.5;
        },this);

        this._text = ToolMrg.getText(104,0,32,0x333333);
        this.addChild(this._text);
        this._text.height = 115;
        this._text.verticalAlign = egret.VerticalAlign.MIDDLE;
        this._text.text = text

        let btn = new egret.Bitmap();
        this.addChild(btn);
        btn.x = 694;
        RES.getResByUrl("resource/assets/images/ui/xq1_nav@2x.png",(e)=>{
            btn.$setBitmapData(e);
        btn.y = (115-btn.height)*0.5;
        },this);

        let link = new egret.Shape();
        this.addChild(link);
        link.graphics.beginFill(0xdedede);
        link.graphics.drawRect(0,113,750,1.5);

        this.setDB();
    }

    private touchDown(e:egret.TouchEvent):void{
        if(this._id==0){

        }else if(this._id==1){

        }
    }

    private _mShareC: egret.Shape;
	/**适配处理 */
	private setDB(): void {
		this._mShareC = new egret.Shape();
		this._mShareC.graphics.beginFill(0xffffff, 1);
		this._mShareC.graphics.drawRect(0, 0, GameMain.getInstance.StageWidth, 115);
		this.addChildAt(this._mShareC, 0);
        this._mShareC.touchEnabled = true;
        this._mShareC.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchDown,this);
	}

}